<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>java 使用POI创建、导出word文档</title>
    <url>/2023/08/07/PIO-XWPF/</url>
    <content><![CDATA[<p>​		前段时间有个导出word需求，通过Apache POI来开发。POI可以操作MSOffice中常用的三件套Word、Excel、PowerPoint，并且支持2007以上的版本。因为项目针对Word，所以只研究了下POI中XWPF的一些特性，从而达到代码操作生成Word的效果。</p>
<h4 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="创建文档代码"><a href="#创建文档代码" class="headerlink" title="创建文档代码"></a>创建文档代码</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">XWPFDocument</span> <span class="variable">document</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XWPFDocument</span>(); <span class="comment">//创建文档</span></span><br><span class="line">      XWPFParagraph paragraph=document.createParagraph(); <span class="comment">//创建段落</span></span><br><span class="line">      paragraph.setAlignment(ParagraphAlignment.LEFT); <span class="comment">//段落左对齐</span></span><br><span class="line">      XWPFRun run=titleParagraph.createRun();  <span class="comment">//创建run</span></span><br><span class="line">      run.setBold(<span class="literal">true</span>); <span class="comment">//粗体</span></span><br><span class="line">      run.setFontSize(<span class="number">15</span>); <span class="comment">//字号</span></span><br><span class="line">      run.setFontFamily(<span class="string">&quot;宋体&quot;</span>); <span class="comment">//字体</span></span><br><span class="line">      run.setText(<span class="string">&quot;&quot;</span>);  <span class="comment">//输入内容</span></span><br><span class="line">run.addBreak(); <span class="comment">//换行</span></span><br><span class="line"></span><br><span class="line">paragraph.setPageBreak(<span class="literal">true</span>);<span class="comment">//分页</span></span><br><span class="line"></span><br><span class="line">      <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> <span class="string">&quot;xxx.docx&quot;</span>;</span><br><span class="line">      <span class="comment">// 保存文档</span></span><br><span class="line">      <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(path);</span><br><span class="line">      document.write(out);</span><br><span class="line"></span><br><span class="line">      out.close();</span><br><span class="line">      document.close(); </span><br></pre></td></tr></table></figure>

<h4 id="创建word表格代码"><a href="#创建word表格代码" class="headerlink" title="创建word表格代码"></a>创建word表格代码</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">XWPFDocument</span> <span class="variable">document</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XWPFDocument</span>(); <span class="comment">//创建文档</span></span><br><span class="line"><span class="type">XWPFTable</span> <span class="variable">table</span> <span class="operator">=</span> document.createTable(<span class="number">1</span>, <span class="number">4</span>);  <span class="comment">//创建表格</span></span><br><span class="line">table.setWidthType(TableWidthType.AUTO);  <span class="comment">//自适应行宽</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取第一行</span></span><br><span class="line"><span class="type">XWPFTableRow</span> <span class="variable">row1</span> <span class="operator">=</span> table.getRow(<span class="number">0</span>);</span><br><span class="line">row1.getCell(<span class="number">0</span>).setWidth(String.valueOf(<span class="number">1500</span>));<span class="comment">//第一个单元格行宽</span></span><br><span class="line">row1.getCell(<span class="number">0</span>).getParagraphArray(<span class="number">0</span>).createRun().setText(<span class="string">&quot;&quot;</span>);<span class="comment">//输入内容</span></span><br><span class="line"></span><br><span class="line"><span class="type">XWPFTableRow</span> <span class="variable">row</span> <span class="operator">=</span> table.createRow();  <span class="comment">//在原来的表格上添加一行</span></span><br><span class="line">row.getCell(<span class="number">1</span>).getParagraphArray(<span class="number">0</span>).createRun().setText(<span class="string">&quot; &quot;</span>); <span class="comment">//每个单元格只有一个段落</span></span><br><span class="line">row.getCell(<span class="number">1</span>).addParagraph().createRun().setText(<span class="string">&quot; &quot;</span>);<span class="comment">//添加段落</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//设置表的单元格样式</span></span><br><span class="line">List&lt;XWPFTableRow&gt; rows = table.getRows();</span><br><span class="line"><span class="keyword">for</span>(XWPFTableRow row : rows)&#123;</span><br><span class="line">    List&lt;XWPFTableCell&gt; cells = row.getTableCells();</span><br><span class="line">    <span class="keyword">for</span>(XWPFTableCell cell : cells)&#123;</span><br><span class="line">        <span class="comment">//单元格内容居中</span></span><br><span class="line">        cell.setVerticalAlignment(XWPFTableCell.XWPFVertAlign.CENTER);  </span><br><span class="line">        List&lt;XWPFParagraph&gt; XWPFParagraphs = cell.getParagraphs();</span><br><span class="line">        <span class="keyword">for</span>(XWPFParagraph paragraph : XWPFParagraphs)&#123;</span><br><span class="line">            paragraph.setIndentFromLeft(<span class="number">100</span>); <span class="comment">//左边距</span></span><br><span class="line">            paragraph.setIndentFromRight(<span class="number">200</span>); <span class="comment">//右边距</span></span><br><span class="line">            List&lt;XWPFRun&gt; runs = paragraph.getRuns();</span><br><span class="line">            <span class="keyword">for</span>(XWPFRun tableRun : runs)&#123;</span><br><span class="line">                tableRun.setFontSize(<span class="number">9</span>);</span><br><span class="line">                tableRun.setFontFamily(<span class="string">&quot;宋体&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>java</category>
      </categories>
  </entry>
</search>
